{"logs": [], "results": [{"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nselect\n    *, REGEXP_SUBSTR(HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nfrom DEPUTY_CREATED", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_created_bronze"], "unique_id": "model.deputy.deputy_created_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_created_bronze.sql", "original_file_path": "models/bronze/deputy_created_bronze.sql", "name": "deputy_created_bronze", "resource_type": "model", "alias": "deputy_created_bronze", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": []}, "description": "Raw deputy_created table with region added", "columns": {"DEPUTY_ID": {"name": "DEPUTY_ID", "description": "", "meta": {}, "data_type": null, "tags": []}, "REGION": {"name": "REGION", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/bronze/deputy_created_bronze.sql", "compiled": true, "compiled_sql": "\n\nselect\n    *, REGEXP_SUBSTR(HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nfrom DEPUTY_CREATED", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nselect\n    *, REGEXP_SUBSTR(HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nfrom DEPUTY_CREATED"}, "error": null, "status": "SUCCESS 1", "execution_time": 3.7906339168548584, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-14T23:59:50.608390Z", "completed_at": "2020-08-14T23:59:50.651129Z"}, {"name": "execute", "started_at": "2020-08-14T23:59:50.651446Z", "completed_at": "2020-08-14T23:59:53.875152Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nSELECT du.*, uuid_string(uuid_string(),DEPUTY_ID) as uuid \n    FROM DEPUTY_UPDATED du", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_updated_bronze"], "unique_id": "model.deputy.deputy_updated_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_updated_bronze.sql", "original_file_path": "models/bronze/deputy_updated_bronze.sql", "name": "deputy_updated_bronze", "resource_type": "model", "alias": "deputy_updated_bronze", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": []}, "description": "Raw deputy_updated table with a unique identifier added", "columns": {"UUID": {"name": "UUID", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/bronze/deputy_updated_bronze.sql", "compiled": true, "compiled_sql": "\n\nSELECT du.*, uuid_string(uuid_string(),DEPUTY_ID) as uuid \n    FROM DEPUTY_UPDATED du", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT du.*, uuid_string(uuid_string(),DEPUTY_ID) as uuid \n    FROM DEPUTY_UPDATED du"}, "error": null, "status": "SUCCESS 1", "execution_time": 3.636685609817505, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-14T23:59:54.402055Z", "completed_at": "2020-08-14T23:59:54.431409Z"}, {"name": "execute", "started_at": "2020-08-14T23:59:54.431723Z", "completed_at": "2020-08-14T23:59:57.501134Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nSELECT dc.DEPUTY_EDITION, \n    dc.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    dc.REGION\nFROM {{ ref('deputy_created_bronze') }} dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "silver", "deputy_user_silver"], "unique_id": "model.deputy.deputy_user_silver", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "silver/deputy_user_silver.sql", "original_file_path": "models/silver/deputy_user_silver.sql", "name": "deputy_user_silver", "resource_type": "model", "alias": "deputy_user_silver", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_created_bronze"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_created_bronze"]}, "description": "Base user table, contains everything from deputy_created_bronze with CREATED_AT, DELETED_AT added", "columns": {"DEPUTY_ID": {"name": "DEPUTY_ID", "description": "", "meta": {}, "data_type": null, "tags": []}, "CREATED_AT": {"name": "CREATED_AT", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/silver/deputy_user_silver.sql", "compiled": true, "compiled_sql": "\n\nSELECT dc.DEPUTY_EDITION, \n    dc.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    dc.REGION\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_created_bronze dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT dc.DEPUTY_EDITION, \n    dc.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    dc.REGION\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_created_bronze dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID"}, "error": null, "status": "SUCCESS 1", "execution_time": 3.772742509841919, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-14T23:59:58.041745Z", "completed_at": "2020-08-14T23:59:58.073787Z"}, {"name": "execute", "started_at": "2020-08-14T23:59:58.074103Z", "completed_at": "2020-08-15T00:00:01.276799Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "SELECT t1.*\nFROM {{ ref('deputy_updated_bronze') }} AS t1\nLEFT JOIN {{ ref('deputy_updated_bronze') }} AS t2\n  ON t1.DEPUTY_ID = t2.DEPUTY_ID \n        AND (t1.TIMESTAMP < t2.TIMESTAMP \n         OR (t1.TIMESTAMP = t2.TIMESTAMP AND t1.UUID < t2.UUID))\nWHERE t2.DEPUTY_ID IS NULL", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "silver", "deputy_last_updated_silver"], "unique_id": "model.deputy.deputy_last_updated_silver", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "silver/deputy_last_updated_silver.sql", "original_file_path": "models/silver/deputy_last_updated_silver.sql", "name": "deputy_last_updated_silver", "resource_type": "model", "alias": "deputy_last_updated_silver", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_updated_bronze"], ["deputy_updated_bronze"]], "sources": [], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_updated_bronze", "model.deputy.deputy_updated_bronze"]}, "description": "Contains the last deputy_updated event for a user. Useful to see user's current DEPUTY_EDITION", "columns": {"DEPUTY_ID": {"name": "DEPUTY_ID", "description": "", "meta": {}, "data_type": null, "tags": []}, "DEPUTY_EDITION": {"name": "DEPUTY_EDITION", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/silver/deputy_last_updated_silver.sql", "compiled": true, "compiled_sql": "SELECT t1.*\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS t1\nLEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS t2\n  ON t1.DEPUTY_ID = t2.DEPUTY_ID \n        AND (t1.TIMESTAMP < t2.TIMESTAMP \n         OR (t1.TIMESTAMP = t2.TIMESTAMP AND t1.UUID < t2.UUID))\nWHERE t2.DEPUTY_ID IS NULL", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "SELECT t1.*\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS t1\nLEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS t2\n  ON t1.DEPUTY_ID = t2.DEPUTY_ID \n        AND (t1.TIMESTAMP < t2.TIMESTAMP \n         OR (t1.TIMESTAMP = t2.TIMESTAMP AND t1.UUID < t2.UUID))\nWHERE t2.DEPUTY_ID IS NULL"}, "error": null, "status": "SUCCESS 1", "execution_time": 3.0347702503204346, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T00:00:01.817521Z", "completed_at": "2020-08-15T00:00:01.849681Z"}, {"name": "execute", "started_at": "2020-08-15T00:00:01.850019Z", "completed_at": "2020-08-15T00:00:04.209812Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"view\") }}\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM {{ ref('deputy_user_silver') }}", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "gold", "deputy_user_stats_gold"], "unique_id": "model.deputy.deputy_user_stats_gold", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "gold/deputy_user_stats_gold.sql", "original_file_path": "models/gold/deputy_user_stats_gold.sql", "name": "deputy_user_stats_gold", "resource_type": "model", "alias": "deputy_user_stats_gold", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "Statistics for users eg total active users", "columns": {"TOTAL_USERS": {"name": "TOTAL_USERS", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/gold/deputy_user_stats_gold.sql", "compiled": true, "compiled_sql": "\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver"}, "error": null, "status": "SUCCESS 1", "execution_time": 3.4157493114471436, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T00:00:04.855407Z", "completed_at": "2020-08-15T00:00:04.887404Z"}, {"name": "execute", "started_at": "2020-08-15T00:00:04.887745Z", "completed_at": "2020-08-15T00:00:07.670798Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nSELECT dc.DEPUTY_EDITION, \ndl.DEPUTY_EDITION as CONVERTED_TO, \ndc.TIMESTAMP as START_TIME, \ndl.TIMESTAMP as END_TIME, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES, \ndc.DEPUTY_EDITION_ID, \ndc.DEPUTY_ID, \ndc.HOSTNAME, \ndc.PORTFOLIO_NAME, \ndc.REGION\nFROM {{ ref('deputy_created_bronze') }} dc \nLEFT JOIN {{ ref('deputy_last_updated_silver') }} dl ON dc.DEPUTY_ID = dl.DEPUTY_ID\nWHERE dc.DEPUTY_EDITION IN ('free', 'pro_trial') AND dl.DEPUTY_EDITION NOT IN ('free', 'pro_trial')", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "silver", "deputy_user_conversions_silver"], "unique_id": "model.deputy.deputy_user_conversions_silver", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "silver/deputy_user_conversions_silver.sql", "original_file_path": "models/silver/deputy_user_conversions_silver.sql", "name": "deputy_user_conversions_silver", "resource_type": "model", "alias": "deputy_user_conversions_silver", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_created_bronze"], ["deputy_last_updated_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_created_bronze", "model.deputy.deputy_last_updated_silver"]}, "description": "User's DEPUTY_EDITION conversions and the time taken", "columns": {"END_TIME": {"name": "END_TIME", "description": "", "meta": {}, "data_type": null, "tags": []}, "START_TIME": {"name": "START_TIME", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/silver/deputy_user_conversions_silver.sql", "compiled": true, "compiled_sql": "\n\nSELECT dc.DEPUTY_EDITION, \ndl.DEPUTY_EDITION as CONVERTED_TO, \ndc.TIMESTAMP as START_TIME, \ndl.TIMESTAMP as END_TIME, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES, \ndc.DEPUTY_EDITION_ID, \ndc.DEPUTY_ID, \ndc.HOSTNAME, \ndc.PORTFOLIO_NAME, \ndc.REGION\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_created_bronze dc \nLEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_last_updated_silver dl ON dc.DEPUTY_ID = dl.DEPUTY_ID\nWHERE dc.DEPUTY_EDITION IN ('free', 'pro_trial') AND dl.DEPUTY_EDITION NOT IN ('free', 'pro_trial')", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT dc.DEPUTY_EDITION, \ndl.DEPUTY_EDITION as CONVERTED_TO, \ndc.TIMESTAMP as START_TIME, \ndl.TIMESTAMP as END_TIME, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES, \ndc.DEPUTY_EDITION_ID, \ndc.DEPUTY_ID, \ndc.HOSTNAME, \ndc.PORTFOLIO_NAME, \ndc.REGION\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_created_bronze dc \nLEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_last_updated_silver dl ON dc.DEPUTY_ID = dl.DEPUTY_ID\nWHERE dc.DEPUTY_EDITION IN ('free', 'pro_trial') AND dl.DEPUTY_EDITION NOT IN ('free', 'pro_trial')"}, "error": null, "status": "SUCCESS 1", "execution_time": 4.446555137634277, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T00:00:08.274169Z", "completed_at": "2020-08-15T00:00:08.305254Z"}, {"name": "execute", "started_at": "2020-08-15T00:00:08.305539Z", "completed_at": "2020-08-15T00:00:12.051644Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM {{ ref('deputy_user_conversions_silver') }}", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "gold", "deputy_user_conversions_gold"], "unique_id": "model.deputy.deputy_user_conversions_gold", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "gold/deputy_user_conversions_gold.sql", "original_file_path": "models/gold/deputy_user_conversions_gold.sql", "name": "deputy_user_conversions_gold", "resource_type": "model", "alias": "deputy_user_conversions_gold", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_user_conversions_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_user_conversions_silver"]}, "description": "Statistics on conversions", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/gold/deputy_user_conversions_gold.sql", "compiled": true, "compiled_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_conversions_silver", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_conversions_silver"}, "error": null, "status": "SUCCESS 1", "execution_time": 3.02763295173645, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T00:00:12.724351Z", "completed_at": "2020-08-15T00:00:12.752033Z"}, {"name": "execute", "started_at": "2020-08-15T00:00:12.752374Z", "completed_at": "2020-08-15T00:00:15.058753Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-08-15T00:00:18.457894Z", "elapsed_time": 34.672203540802}