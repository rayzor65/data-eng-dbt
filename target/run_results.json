{"logs": [], "results": [{"node": {"raw_sql": "{{ config(materialized=\"view\") }}\n\nSELECT * FROM DEPUTY_CREATED\nUNION\nSELECT * FROM DEPUTY_UPDATED", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_events_bronze"], "unique_id": "model.deputy.deputy_events_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_events_bronze.sql", "original_file_path": "models/bronze/deputy_events_bronze.sql", "name": "deputy_events_bronze", "resource_type": "model", "alias": "deputy_events_bronze", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "Raw deputy_created + deputy_updated table", "columns": {"DEPUTY_EDITION_ID": {"name": "DEPUTY_EDITION_ID", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/compiled/deputy/models/bronze/deputy_events_bronze.sql", "compiled": true, "compiled_sql": "\n\nSELECT * FROM DEPUTY_CREATED\nUNION\nSELECT * FROM DEPUTY_UPDATED", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT * FROM DEPUTY_CREATED\nUNION\nSELECT * FROM DEPUTY_UPDATED"}, "error": null, "status": null, "execution_time": 0.04701948165893555, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.430712Z", "completed_at": "2020-08-16T10:44:22.476784Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.477245Z", "completed_at": "2020-08-16T10:44:22.477262Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"view\") }}\n\nSELECT du.*, row_number() over (order by DEPUTY_ID, TIMESTAMP) as ROW_NUMBER\n    FROM DEPUTY_UPDATED du\n    ORDER BY DEPUTY_ID, TIMESTAMP", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_updated_bronze"], "unique_id": "model.deputy.deputy_updated_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_updated_bronze.sql", "original_file_path": "models/bronze/deputy_updated_bronze.sql", "name": "deputy_updated_bronze", "resource_type": "model", "alias": "deputy_updated_bronze", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/bronze/deputy_updated_bronze.sql", "compiled": true, "compiled_sql": "\n\nSELECT du.*, row_number() over (order by DEPUTY_ID, TIMESTAMP) as ROW_NUMBER\n    FROM DEPUTY_UPDATED du\n    ORDER BY DEPUTY_ID, TIMESTAMP", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT du.*, row_number() over (order by DEPUTY_ID, TIMESTAMP) as ROW_NUMBER\n    FROM DEPUTY_UPDATED du\n    ORDER BY DEPUTY_ID, TIMESTAMP"}, "error": null, "status": null, "execution_time": 0.029405832290649414, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.477917Z", "completed_at": "2020-08-16T10:44:22.506514Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.506925Z", "completed_at": "2020-08-16T10:44:22.506935Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "with du as (\n    SELECT DEPUTY_ID, \n        DEPUTY_EDITION_ID, \n        LAG(DEPUTY_EDITION_ID, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION_ID, \n        DEPUTY_EDITION_ID - PREV_DEPUTY_EDITION_ID as DIFF_TO_PREV, \n        DEPUTY_EDITION, \n        LAG(DEPUTY_EDITION, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION, \n        TIMESTAMP as END_TIME,\n        LAG(TIMESTAMP, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as START_TIME\n    FROM {{ ref('deputy_events_bronze') }} \n)\n\nSELECT *, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES\nFROM du\nORDER BY DEPUTY_ID, START_TIME", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_conversions_bronze"], "unique_id": "model.deputy.deputy_conversions_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_conversions_bronze.sql", "original_file_path": "models/bronze/deputy_conversions_bronze.sql", "name": "deputy_conversions_bronze", "resource_type": "model", "alias": "deputy_conversions_bronze", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_events_bronze"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.deputy.deputy_events_bronze"]}, "description": "Base conversions table", "columns": {"END_TIME": {"name": "END_TIME", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/compiled/deputy/models/bronze/deputy_conversions_bronze.sql", "compiled": true, "compiled_sql": "with du as (\n    SELECT DEPUTY_ID, \n        DEPUTY_EDITION_ID, \n        LAG(DEPUTY_EDITION_ID, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION_ID, \n        DEPUTY_EDITION_ID - PREV_DEPUTY_EDITION_ID as DIFF_TO_PREV, \n        DEPUTY_EDITION, \n        LAG(DEPUTY_EDITION, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION, \n        TIMESTAMP as END_TIME,\n        LAG(TIMESTAMP, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as START_TIME\n    FROM ANALYTICS_ENG_DB.dbt_rho.deputy_events_bronze \n)\n\nSELECT *, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES\nFROM du\nORDER BY DEPUTY_ID, START_TIME", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "with du as (\n    SELECT DEPUTY_ID, \n        DEPUTY_EDITION_ID, \n        LAG(DEPUTY_EDITION_ID, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION_ID, \n        DEPUTY_EDITION_ID - PREV_DEPUTY_EDITION_ID as DIFF_TO_PREV, \n        DEPUTY_EDITION, \n        LAG(DEPUTY_EDITION, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION, \n        TIMESTAMP as END_TIME,\n        LAG(TIMESTAMP, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as START_TIME\n    FROM ANALYTICS_ENG_DB.dbt_rho.deputy_events_bronze \n)\n\nSELECT *, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES\nFROM du\nORDER BY DEPUTY_ID, START_TIME"}, "error": null, "status": null, "execution_time": 0.028966903686523438, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.507557Z", "completed_at": "2020-08-16T10:44:22.535700Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.536118Z", "completed_at": "2020-08-16T10:44:22.536128Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "DEPUTY_EDITION_ID", "model": "{{ ref('deputy_events_bronze') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "not_null_deputy_events_bronze_DEPUTY_EDITION_ID"], "unique_id": "test.deputy.not_null_deputy_events_bronze_DEPUTY_EDITION_ID", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/not_null_deputy_events_bronze_DEPUTY_EDITION_ID.sql", "original_file_path": "models/tests.yml", "name": "not_null_deputy_events_bronze_DEPUTY_EDITION_ID", "resource_type": "test", "alias": "not_null_deputy_events_bronze_DEPUTY_EDITION_ID", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_events_bronze"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.deputy.deputy_events_bronze"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/not_null_deputy_events_bronze_DEPUTY_EDITION_ID.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom ANALYTICS_ENG_DB.dbt_rho.deputy_events_bronze\nwhere DEPUTY_EDITION_ID is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom ANALYTICS_ENG_DB.dbt_rho.deputy_events_bronze\nwhere DEPUTY_EDITION_ID is null\n\n", "column_name": "DEPUTY_EDITION_ID"}, "error": null, "status": null, "execution_time": 0.045057058334350586, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.536769Z", "completed_at": "2020-08-16T10:44:22.581022Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.581421Z", "completed_at": "2020-08-16T10:44:22.581433Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "with last_updated as (\n    SELECT d1.*\n    FROM {{ ref('deputy_updated_bronze') }} AS d1\n    LEFT JOIN {{ ref('deputy_updated_bronze') }} AS d2\n    ON d1.DEPUTY_ID = d2.DEPUTY_ID \n            AND (d1.TIMESTAMP < d2.TIMESTAMP \n            OR (d1.TIMESTAMP = d2.TIMESTAMP AND d1.ROW_NUMBER < d2.ROW_NUMBER))\n    WHERE d2.DEPUTY_ID IS NULL\n)\n\nSELECT lu.DEPUTY_EDITION, \n    lu.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    REGEXP_SUBSTR(dc.HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nFROM DEPUTY_CREATED dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID\nLEFT JOIN last_updated lu ON dc.DEPUTY_ID = lu.DEPUTY_ID", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "silver", "deputy_user_silver"], "unique_id": "model.deputy.deputy_user_silver", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "silver/deputy_user_silver.sql", "original_file_path": "models/silver/deputy_user_silver.sql", "name": "deputy_user_silver", "resource_type": "model", "alias": "deputy_user_silver", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_updated_bronze"], ["deputy_updated_bronze"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.deputy.deputy_updated_bronze", "model.deputy.deputy_updated_bronze"]}, "description": "Base user table, contains everything from deputy_created_bronze with CREATED_AT, DELETED_AT added", "columns": {"DEPUTY_ID": {"name": "DEPUTY_ID", "description": "", "meta": {}, "data_type": null, "tags": []}, "CREATED_AT": {"name": "CREATED_AT", "description": "", "meta": {}, "data_type": null, "tags": []}, "DEPUTY_EDITION": {"name": "DEPUTY_EDITION", "description": "", "meta": {}, "data_type": null, "tags": []}, "REGION": {"name": "REGION", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/compiled/deputy/models/silver/deputy_user_silver.sql", "compiled": true, "compiled_sql": "with last_updated as (\n    SELECT d1.*\n    FROM ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS d1\n    LEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS d2\n    ON d1.DEPUTY_ID = d2.DEPUTY_ID \n            AND (d1.TIMESTAMP < d2.TIMESTAMP \n            OR (d1.TIMESTAMP = d2.TIMESTAMP AND d1.ROW_NUMBER < d2.ROW_NUMBER))\n    WHERE d2.DEPUTY_ID IS NULL\n)\n\nSELECT lu.DEPUTY_EDITION, \n    lu.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    REGEXP_SUBSTR(dc.HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nFROM DEPUTY_CREATED dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID\nLEFT JOIN last_updated lu ON dc.DEPUTY_ID = lu.DEPUTY_ID", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "with last_updated as (\n    SELECT d1.*\n    FROM ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS d1\n    LEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS d2\n    ON d1.DEPUTY_ID = d2.DEPUTY_ID \n            AND (d1.TIMESTAMP < d2.TIMESTAMP \n            OR (d1.TIMESTAMP = d2.TIMESTAMP AND d1.ROW_NUMBER < d2.ROW_NUMBER))\n    WHERE d2.DEPUTY_ID IS NULL\n)\n\nSELECT lu.DEPUTY_EDITION, \n    lu.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    REGEXP_SUBSTR(dc.HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nFROM DEPUTY_CREATED dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID\nLEFT JOIN last_updated lu ON dc.DEPUTY_ID = lu.DEPUTY_ID"}, "error": null, "status": null, "execution_time": 0.031725406646728516, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.582057Z", "completed_at": "2020-08-16T10:44:22.612872Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.613367Z", "completed_at": "2020-08-16T10:44:22.613379Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "SELECT * \nFROM {{ ref('deputy_conversions_bronze') }} \nWHERE (DIFF_TO_PREV = DEPUTY_EDITION_ID OR (DIFF_TO_PREV = DEPUTY_EDITION_ID - 1)) AND DEPUTY_EDITION_ID != 0\nORDER BY DEPUTY_ID, START_TIME", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "silver", "deputy_paid_conversions_silver"], "unique_id": "model.deputy.deputy_paid_conversions_silver", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "silver/deputy_paid_conversions_silver.sql", "original_file_path": "models/silver/deputy_paid_conversions_silver.sql", "name": "deputy_paid_conversions_silver", "resource_type": "model", "alias": "deputy_paid_conversions_silver", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_conversions_bronze"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.deputy.deputy_conversions_bronze"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/silver/deputy_paid_conversions_silver.sql", "compiled": true, "compiled_sql": "SELECT * \nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_conversions_bronze \nWHERE (DIFF_TO_PREV = DEPUTY_EDITION_ID OR (DIFF_TO_PREV = DEPUTY_EDITION_ID - 1)) AND DEPUTY_EDITION_ID != 0\nORDER BY DEPUTY_ID, START_TIME", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "SELECT * \nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_conversions_bronze \nWHERE (DIFF_TO_PREV = DEPUTY_EDITION_ID OR (DIFF_TO_PREV = DEPUTY_EDITION_ID - 1)) AND DEPUTY_EDITION_ID != 0\nORDER BY DEPUTY_ID, START_TIME"}, "error": null, "status": null, "execution_time": 0.0302126407623291, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.614020Z", "completed_at": "2020-08-16T10:44:22.643402Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.643827Z", "completed_at": "2020-08-16T10:44:22.643838Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "END_TIME", "model": "{{ ref('deputy_conversions_bronze') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "not_null_deputy_conversions_bronze_END_TIME"], "unique_id": "test.deputy.not_null_deputy_conversions_bronze_END_TIME", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/not_null_deputy_conversions_bronze_END_TIME.sql", "original_file_path": "models/tests.yml", "name": "not_null_deputy_conversions_bronze_END_TIME", "resource_type": "test", "alias": "not_null_deputy_conversions_bronze_END_TIME", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_conversions_bronze"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.deputy.deputy_conversions_bronze"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/not_null_deputy_conversions_bronze_END_TIME.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom ANALYTICS_ENG_DB.dbt_rho.deputy_conversions_bronze\nwhere END_TIME is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom ANALYTICS_ENG_DB.dbt_rho.deputy_conversions_bronze\nwhere END_TIME is null\n\n", "column_name": "END_TIME"}, "error": null, "status": null, "execution_time": 0.03164529800415039, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.644469Z", "completed_at": "2020-08-16T10:44:22.675262Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.675705Z", "completed_at": "2020-08-16T10:44:22.675715Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"view\") }}\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM {{ ref('deputy_user_silver') }}", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "gold", "deputy_user_stats_gold"], "unique_id": "model.deputy.deputy_user_stats_gold", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "gold/deputy_user_stats_gold.sql", "original_file_path": "models/gold/deputy_user_stats_gold.sql", "name": "deputy_user_stats_gold", "resource_type": "model", "alias": "deputy_user_stats_gold", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "Statistics for users eg total active users", "columns": {"TOTAL_USERS": {"name": "TOTAL_USERS", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/compiled/deputy/models/gold/deputy_user_stats_gold.sql", "compiled": true, "compiled_sql": "\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver"}, "error": null, "status": null, "execution_time": 0.03186607360839844, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.676349Z", "completed_at": "2020-08-16T10:44:22.707373Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.707813Z", "completed_at": "2020-08-16T10:44:22.707823Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_accepted_values(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "accepted_values", "kwargs": {"values": ["pro_trial", "paid_premium", "paid_scheduling_only", "free", "paid_flexi", "enterprise", "mobile_only", "yearly", "paid_timesheet_only"], "column_name": "DEPUTY_EDITION", "model": "{{ ref('deputy_user_silver') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "accepted_values_deputy_user_silver_DEPUTY_EDITION__pro_trial__paid_premium__paid_scheduling_only__free__paid_flexi__enterprise__mobile_only__yearly__paid_timesheet_only"], "unique_id": "test.deputy.accepted_values_deputy_user_silver_DEPUTY_EDITION__pro_trial__paid_premium__paid_scheduling_only__free__paid_flexi__enterprise__mobile_only__yearly__paid_timesheet_only", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/accepted_values_deputy_user_silver_7bf927292b8ad6f1865c0697597148d4.sql", "original_file_path": "models/tests.yml", "name": "accepted_values_deputy_user_silver_DEPUTY_EDITION__pro_trial__paid_premium__paid_scheduling_only__free__paid_flexi__enterprise__mobile_only__yearly__paid_timesheet_only", "resource_type": "test", "alias": "accepted_values_deputy_user_silver_DEPUTY_EDITION__pro_trial__paid_premium__paid_scheduling_only__free__paid_flexi__enterprise__mobile_only__yearly__paid_timesheet_only", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values"], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/accepted_values_deputy_user_silver_7bf927292b8ad6f1865c0697597148d4.sql", "compiled": true, "compiled_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        DEPUTY_EDITION as value_field\n\n    from ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'pro_trial','paid_premium','paid_scheduling_only','free','paid_flexi','enterprise','mobile_only','yearly','paid_timesheet_only'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        DEPUTY_EDITION as value_field\n\n    from ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'pro_trial','paid_premium','paid_scheduling_only','free','paid_flexi','enterprise','mobile_only','yearly','paid_timesheet_only'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "column_name": "DEPUTY_EDITION"}, "error": null, "status": null, "execution_time": 0.03659558296203613, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.708454Z", "completed_at": "2020-08-16T10:44:22.744226Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.744643Z", "completed_at": "2020-08-16T10:44:22.744653Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_accepted_values(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "accepted_values", "kwargs": {"values": ["au", "uk", "eu", "na", "as"], "column_name": "REGION", "model": "{{ ref('deputy_user_silver') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "accepted_values_deputy_user_silver_REGION__au__uk__eu__na__as"], "unique_id": "test.deputy.accepted_values_deputy_user_silver_REGION__au__uk__eu__na__as", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/accepted_values_deputy_user_silver_REGION__au__uk__eu__na__as.sql", "original_file_path": "models/tests.yml", "name": "accepted_values_deputy_user_silver_REGION__au__uk__eu__na__as", "resource_type": "test", "alias": "accepted_values_deputy_user_silver_REGION__au__uk__eu__na__as", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values"], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/accepted_values_deputy_user_silver_REGION__au__uk__eu__na__as.sql", "compiled": true, "compiled_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        REGION as value_field\n\n    from ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'au','uk','eu','na','as'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        REGION as value_field\n\n    from ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'au','uk','eu','na','as'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "column_name": "REGION"}, "error": null, "status": null, "execution_time": 0.03170013427734375, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.745318Z", "completed_at": "2020-08-16T10:44:22.776196Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.776613Z", "completed_at": "2020-08-16T10:44:22.776622Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ dbt_utils.test_equal_rowcount(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": "dbt_utils", "name": "equal_rowcount", "kwargs": {"compare_model": "DEPUTY_CREATED", "model": "{{ ref('deputy_user_silver') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "dbt_utils_equal_rowcount_deputy_user_silver_DEPUTY_CREATED"], "unique_id": "test.deputy.dbt_utils_equal_rowcount_deputy_user_silver_DEPUTY_CREATED", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/dbt_utils_equal_rowcount_deputy_user_silver_DEPUTY_CREATED.sql", "original_file_path": "models/tests.yml", "name": "dbt_utils_equal_rowcount_deputy_user_silver_DEPUTY_CREATED", "resource_type": "test", "alias": "dbt_utils_equal_rowcount_deputy_user_silver_DEPUTY_CREATED", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt_utils.test_equal_rowcount"], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/dbt_utils_equal_rowcount_deputy_user_silver_DEPUTY_CREATED.sql", "compiled": true, "compiled_sql": "\n\n\n\nwith a as (\n\n    select count(*) as count_a from ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\n\n),\nb as (\n\n    select count(*) as count_b from DEPUTY_CREATED\n\n),\nfinal as (\n\n    select abs(\n            (select count_a from a) -\n            (select count_b from b)\n            )\n        as diff_count\n\n)\n\nselect diff_count from final\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nwith a as (\n\n    select count(*) as count_a from ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\n\n),\nb as (\n\n    select count(*) as count_b from DEPUTY_CREATED\n\n),\nfinal as (\n\n    select abs(\n            (select count_a from a) -\n            (select count_b from b)\n            )\n        as diff_count\n\n)\n\nselect diff_count from final\n\n", "column_name": null}, "error": null, "status": null, "execution_time": 0.03314018249511719, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.777299Z", "completed_at": "2020-08-16T10:44:22.809609Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.810021Z", "completed_at": "2020-08-16T10:44:22.810031Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "CREATED_AT", "model": "{{ ref('deputy_user_silver') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "not_null_deputy_user_silver_CREATED_AT"], "unique_id": "test.deputy.not_null_deputy_user_silver_CREATED_AT", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/not_null_deputy_user_silver_CREATED_AT.sql", "original_file_path": "models/tests.yml", "name": "not_null_deputy_user_silver_CREATED_AT", "resource_type": "test", "alias": "not_null_deputy_user_silver_CREATED_AT", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/not_null_deputy_user_silver_CREATED_AT.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\nwhere CREATED_AT is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\nwhere CREATED_AT is null\n\n", "column_name": "CREATED_AT"}, "error": null, "status": null, "execution_time": 0.031064748764038086, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.810680Z", "completed_at": "2020-08-16T10:44:22.840854Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.841334Z", "completed_at": "2020-08-16T10:44:22.841345Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "DEPUTY_ID", "model": "{{ ref('deputy_user_silver') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "not_null_deputy_user_silver_DEPUTY_ID"], "unique_id": "test.deputy.not_null_deputy_user_silver_DEPUTY_ID", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/not_null_deputy_user_silver_DEPUTY_ID.sql", "original_file_path": "models/tests.yml", "name": "not_null_deputy_user_silver_DEPUTY_ID", "resource_type": "test", "alias": "not_null_deputy_user_silver_DEPUTY_ID", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/not_null_deputy_user_silver_DEPUTY_ID.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\nwhere DEPUTY_ID is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\nwhere DEPUTY_ID is null\n\n", "column_name": "DEPUTY_ID"}, "error": null, "status": null, "execution_time": 0.030771970748901367, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.842016Z", "completed_at": "2020-08-16T10:44:22.871981Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.872374Z", "completed_at": "2020-08-16T10:44:22.872384Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "DEPUTY_ID", "model": "{{ ref('deputy_user_silver') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "unique_deputy_user_silver_DEPUTY_ID"], "unique_id": "test.deputy.unique_deputy_user_silver_DEPUTY_ID", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/unique_deputy_user_silver_DEPUTY_ID.sql", "original_file_path": "models/tests.yml", "name": "unique_deputy_user_silver_DEPUTY_ID", "resource_type": "test", "alias": "unique_deputy_user_silver_DEPUTY_ID", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/unique_deputy_user_silver_DEPUTY_ID.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        DEPUTY_ID\n\n    from ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\n    where DEPUTY_ID is not null\n    group by DEPUTY_ID\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        DEPUTY_ID\n\n    from ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver\n    where DEPUTY_ID is not null\n    group by DEPUTY_ID\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "DEPUTY_ID"}, "error": null, "status": null, "execution_time": 0.03142952919006348, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.873085Z", "completed_at": "2020-08-16T10:44:22.903609Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.904033Z", "completed_at": "2020-08-16T10:44:22.904045Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM {{ ref('deputy_paid_conversions_silver') }}", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "gold", "deputy_conversions_stats_gold"], "unique_id": "model.deputy.deputy_conversions_stats_gold", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "gold/deputy_conversions_stats_gold.sql", "original_file_path": "models/gold/deputy_conversions_stats_gold.sql", "name": "deputy_conversions_stats_gold", "resource_type": "model", "alias": "deputy_conversions_stats_gold", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_paid_conversions_silver"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.deputy.deputy_paid_conversions_silver"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/gold/deputy_conversions_stats_gold.sql", "compiled": true, "compiled_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_paid_conversions_silver", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_paid_conversions_silver"}, "error": null, "status": null, "execution_time": 0.028296470642089844, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.904712Z", "completed_at": "2020-08-16T10:44:22.932165Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.932588Z", "completed_at": "2020-08-16T10:44:22.932599Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_total_users(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "total_users", "kwargs": {"column_name": "TOTAL_USERS", "model": "{{ ref('deputy_user_stats_gold') }}"}}, "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "schema_test", "total_users_deputy_user_stats_gold_TOTAL_USERS"], "unique_id": "test.deputy.total_users_deputy_user_stats_gold_TOTAL_USERS", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "schema_test/total_users_deputy_user_stats_gold_TOTAL_USERS.sql", "original_file_path": "models/tests.yml", "name": "total_users_deputy_user_stats_gold_TOTAL_USERS", "resource_type": "test", "alias": "total_users_deputy_user_stats_gold_TOTAL_USERS", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["deputy_user_stats_gold"]], "sources": [], "depends_on": {"macros": ["macro.deputy.test_total_users"], "nodes": ["model.deputy.deputy_user_stats_gold"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/deputy/models/tests.yml/schema_test/total_users_deputy_user_stats_gold_TOTAL_USERS.sql", "compiled": true, "compiled_sql": "\n\nwith validation as (\n\n    select\n        TOTAL_USERS, ACTIVE_USERS, DELETED_USERS\n    from ANALYTICS_ENG_DB.dbt_rho.deputy_user_stats_gold\n),\n\nvalidation_errors as (\n\n    select\n        *\n    from validation\n    WHERE TOTAL_USERS != ACTIVE_USERS + DELETED_USERS\n\n)\n\nselect count(*)\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nwith validation as (\n\n    select\n        TOTAL_USERS, ACTIVE_USERS, DELETED_USERS\n    from ANALYTICS_ENG_DB.dbt_rho.deputy_user_stats_gold\n),\n\nvalidation_errors as (\n\n    select\n        *\n    from validation\n    WHERE TOTAL_USERS != ACTIVE_USERS + DELETED_USERS\n\n)\n\nselect count(*)\nfrom validation_errors\n\n", "column_name": "TOTAL_USERS"}, "error": null, "status": null, "execution_time": 0.03062295913696289, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-08-16T10:44:22.933308Z", "completed_at": "2020-08-16T10:44:22.963122Z"}, {"name": "execute", "started_at": "2020-08-16T10:44:22.963511Z", "completed_at": "2020-08-16T10:44:22.963522Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-08-16T10:44:23.031194Z", "elapsed_time": 2.9084465503692627}