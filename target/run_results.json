{"logs": [], "results": [{"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nselect\n    *, REGEXP_SUBSTR(HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nfrom DEPUTY_CREATED", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_created_bronze"], "unique_id": "model.deputy.deputy_created_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_created_bronze.sql", "original_file_path": "models/bronze/deputy_created_bronze.sql", "name": "deputy_created_bronze", "resource_type": "model", "alias": "deputy_created_bronze", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": []}, "description": "Raw deputy_created table with region added", "columns": {"DEPUTY_ID": {"name": "DEPUTY_ID", "description": "", "meta": {}, "data_type": null, "tags": []}, "REGION": {"name": "REGION", "description": "", "meta": {}, "data_type": null, "tags": []}, "DEPUTY_EDITION": {"name": "DEPUTY_EDITION", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/bronze/deputy_created_bronze.sql", "compiled": true, "compiled_sql": "\n\nselect\n    *, REGEXP_SUBSTR(HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nfrom DEPUTY_CREATED", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nselect\n    *, REGEXP_SUBSTR(HOSTNAME,'\\.(au|uk|eu|na|as)\\.', 1, 1, 'c', 1) as REGION\nfrom DEPUTY_CREATED"}, "error": null, "status": "SUCCESS 1", "execution_time": 4.518586874008179, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:19:47.194382Z", "completed_at": "2020-08-15T03:19:47.235215Z"}, {"name": "execute", "started_at": "2020-08-15T03:19:47.235846Z", "completed_at": "2020-08-15T03:19:51.183896Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nSELECT du.*, uuid_string(uuid_string(),DEPUTY_ID) as uuid \n    FROM DEPUTY_UPDATED du", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_updated_bronze"], "unique_id": "model.deputy.deputy_updated_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_updated_bronze.sql", "original_file_path": "models/bronze/deputy_updated_bronze.sql", "name": "deputy_updated_bronze", "resource_type": "model", "alias": "deputy_updated_bronze", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": []}, "description": "Raw deputy_updated table with a unique identifier added", "columns": {"UUID": {"name": "UUID", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/bronze/deputy_updated_bronze.sql", "compiled": true, "compiled_sql": "\n\nSELECT du.*, uuid_string(uuid_string(),DEPUTY_ID) as uuid \n    FROM DEPUTY_UPDATED du", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT du.*, uuid_string(uuid_string(),DEPUTY_ID) as uuid \n    FROM DEPUTY_UPDATED du"}, "error": null, "status": "SUCCESS 1", "execution_time": 4.937169075012207, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:19:51.716033Z", "completed_at": "2020-08-15T03:19:51.748835Z"}, {"name": "execute", "started_at": "2020-08-15T03:19:51.749159Z", "completed_at": "2020-08-15T03:19:56.126994Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nSELECT * FROM DEPUTY_CREATED\nUNION\nSELECT * FROM DEPUTY_UPDATED", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_events_bronze"], "unique_id": "model.deputy.deputy_events_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_events_bronze.sql", "original_file_path": "models/bronze/deputy_events_bronze.sql", "name": "deputy_events_bronze", "resource_type": "model", "alias": "deputy_events_bronze", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": []}, "description": "Raw deputy_created and deputy_updated table", "columns": {"DEPUTY_EDITION_ID": {"name": "DEPUTY_EDITION_ID", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/bronze/deputy_events_bronze.sql", "compiled": true, "compiled_sql": "\n\nSELECT * FROM DEPUTY_CREATED\nUNION\nSELECT * FROM DEPUTY_UPDATED", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT * FROM DEPUTY_CREATED\nUNION\nSELECT * FROM DEPUTY_UPDATED"}, "error": null, "status": "SUCCESS 1", "execution_time": 4.497260570526123, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:19:56.656087Z", "completed_at": "2020-08-15T03:19:56.684710Z"}, {"name": "execute", "started_at": "2020-08-15T03:19:56.685035Z", "completed_at": "2020-08-15T03:20:00.619192Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nSELECT dc.DEPUTY_EDITION, \n    dc.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    dc.REGION\nFROM {{ ref('deputy_created_bronze') }} dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "silver", "deputy_user_silver"], "unique_id": "model.deputy.deputy_user_silver", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "silver/deputy_user_silver.sql", "original_file_path": "models/silver/deputy_user_silver.sql", "name": "deputy_user_silver", "resource_type": "model", "alias": "deputy_user_silver", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_created_bronze"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_created_bronze"]}, "description": "Base user table, contains everything from deputy_created_bronze with CREATED_AT, DELETED_AT added", "columns": {"DEPUTY_ID": {"name": "DEPUTY_ID", "description": "", "meta": {}, "data_type": null, "tags": []}, "CREATED_AT": {"name": "CREATED_AT", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/silver/deputy_user_silver.sql", "compiled": true, "compiled_sql": "\n\nSELECT dc.DEPUTY_EDITION, \n    dc.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    dc.REGION\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_created_bronze dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT dc.DEPUTY_EDITION, \n    dc.DEPUTY_EDITION_ID, \n    dc.DEPUTY_ID, \n    dc.HOSTNAME,\n    dc.TIMESTAMP as CREATED_AT,\n    dc.PORTFOLIO_NAME, \n    dd.TIMESTAMP as DELETED_AT,\n    dc.REGION\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_created_bronze dc\nLEFT JOIN DEPUTY_DELETED dd ON dc.DEPUTY_ID = dd.DEPUTY_ID"}, "error": null, "status": "SUCCESS 1", "execution_time": 4.9603657722473145, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:20:01.156304Z", "completed_at": "2020-08-15T03:20:01.188354Z"}, {"name": "execute", "started_at": "2020-08-15T03:20:01.188686Z", "completed_at": "2020-08-15T03:20:05.586818Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "SELECT t1.*\nFROM {{ ref('deputy_updated_bronze') }} AS t1\nLEFT JOIN {{ ref('deputy_updated_bronze') }} AS t2\n  ON t1.DEPUTY_ID = t2.DEPUTY_ID \n        AND (t1.TIMESTAMP < t2.TIMESTAMP \n         OR (t1.TIMESTAMP = t2.TIMESTAMP AND t1.UUID < t2.UUID))\nWHERE t2.DEPUTY_ID IS NULL", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "silver", "deputy_last_updated_silver"], "unique_id": "model.deputy.deputy_last_updated_silver", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "silver/deputy_last_updated_silver.sql", "original_file_path": "models/silver/deputy_last_updated_silver.sql", "name": "deputy_last_updated_silver", "resource_type": "model", "alias": "deputy_last_updated_silver", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_updated_bronze"], ["deputy_updated_bronze"]], "sources": [], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_updated_bronze", "model.deputy.deputy_updated_bronze"]}, "description": "Contains the last deputy_updated event for a user. Useful to see user's current DEPUTY_EDITION", "columns": {"DEPUTY_ID": {"name": "DEPUTY_ID", "description": "", "meta": {}, "data_type": null, "tags": []}, "DEPUTY_EDITION": {"name": "DEPUTY_EDITION", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/silver/deputy_last_updated_silver.sql", "compiled": true, "compiled_sql": "SELECT t1.*\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS t1\nLEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS t2\n  ON t1.DEPUTY_ID = t2.DEPUTY_ID \n        AND (t1.TIMESTAMP < t2.TIMESTAMP \n         OR (t1.TIMESTAMP = t2.TIMESTAMP AND t1.UUID < t2.UUID))\nWHERE t2.DEPUTY_ID IS NULL", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "SELECT t1.*\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS t1\nLEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_updated_bronze AS t2\n  ON t1.DEPUTY_ID = t2.DEPUTY_ID \n        AND (t1.TIMESTAMP < t2.TIMESTAMP \n         OR (t1.TIMESTAMP = t2.TIMESTAMP AND t1.UUID < t2.UUID))\nWHERE t2.DEPUTY_ID IS NULL"}, "error": null, "status": "SUCCESS 1", "execution_time": 2.809741973876953, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:20:06.119802Z", "completed_at": "2020-08-15T03:20:06.150350Z"}, {"name": "execute", "started_at": "2020-08-15T03:20:06.150683Z", "completed_at": "2020-08-15T03:20:08.402344Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nwith du as (\n    SELECT DEPUTY_ID, \n        DEPUTY_EDITION_ID, \n        LAG(DEPUTY_EDITION_ID, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION_ID, \n        DEPUTY_EDITION_ID - PREV_DEPUTY_EDITION_ID as DIFF_TO_PREV, \n        TIMESTAMP as END_TIME,\n        LAG(TIMESTAMP, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as START_TIME\n    FROM {{ ref('deputy_events_bronze') }} \n)\n\nSELECT *, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES\nFROM du\nWHERE (DIFF_TO_PREV = DEPUTY_EDITION_ID OR (DIFF_TO_PREV = DEPUTY_EDITION_ID - 1)) AND DEPUTY_EDITION_ID != 0\nORDER BY DEPUTY_ID, START_TIME", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "bronze", "deputy_conversions_bronze"], "unique_id": "model.deputy.deputy_conversions_bronze", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "bronze/deputy_conversions_bronze.sql", "original_file_path": "models/bronze/deputy_conversions_bronze.sql", "name": "deputy_conversions_bronze", "resource_type": "model", "alias": "deputy_conversions_bronze", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_events_bronze"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_events_bronze"]}, "description": "Base conversions table", "columns": {"PREV_DEPUTY_EDITION_ID": {"name": "PREV_DEPUTY_EDITION_ID", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/bronze/deputy_conversions_bronze.sql", "compiled": true, "compiled_sql": "\n\nwith du as (\n    SELECT DEPUTY_ID, \n        DEPUTY_EDITION_ID, \n        LAG(DEPUTY_EDITION_ID, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION_ID, \n        DEPUTY_EDITION_ID - PREV_DEPUTY_EDITION_ID as DIFF_TO_PREV, \n        TIMESTAMP as END_TIME,\n        LAG(TIMESTAMP, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as START_TIME\n    FROM ANALYTICS_ENG_DB.dbt_rho.deputy_events_bronze \n)\n\nSELECT *, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES\nFROM du\nWHERE (DIFF_TO_PREV = DEPUTY_EDITION_ID OR (DIFF_TO_PREV = DEPUTY_EDITION_ID - 1)) AND DEPUTY_EDITION_ID != 0\nORDER BY DEPUTY_ID, START_TIME", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nwith du as (\n    SELECT DEPUTY_ID, \n        DEPUTY_EDITION_ID, \n        LAG(DEPUTY_EDITION_ID, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as PREV_DEPUTY_EDITION_ID, \n        DEPUTY_EDITION_ID - PREV_DEPUTY_EDITION_ID as DIFF_TO_PREV, \n        TIMESTAMP as END_TIME,\n        LAG(TIMESTAMP, 1, null) over (partition by DEPUTY_ID order by TIMESTAMP) as START_TIME\n    FROM ANALYTICS_ENG_DB.dbt_rho.deputy_events_bronze \n)\n\nSELECT *, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES\nFROM du\nWHERE (DIFF_TO_PREV = DEPUTY_EDITION_ID OR (DIFF_TO_PREV = DEPUTY_EDITION_ID - 1)) AND DEPUTY_EDITION_ID != 0\nORDER BY DEPUTY_ID, START_TIME"}, "error": null, "status": "SUCCESS 1", "execution_time": 4.062903881072998, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:20:08.933023Z", "completed_at": "2020-08-15T03:20:08.963676Z"}, {"name": "execute", "started_at": "2020-08-15T03:20:08.964141Z", "completed_at": "2020-08-15T03:20:12.448525Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"view\") }}\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM {{ ref('deputy_user_silver') }}", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "gold", "deputy_user_stats_gold"], "unique_id": "model.deputy.deputy_user_stats_gold", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "gold/deputy_user_stats_gold.sql", "original_file_path": "models/gold/deputy_user_stats_gold.sql", "name": "deputy_user_stats_gold", "resource_type": "model", "alias": "deputy_user_stats_gold", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_user_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_user_silver"]}, "description": "Statistics for users eg total active users", "columns": {"TOTAL_USERS": {"name": "TOTAL_USERS", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/gold/deputy_user_stats_gold.sql", "compiled": true, "compiled_sql": "\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT COUNT(1) as TOTAL_USERS, \nCOUNT(IFF(DELETED_AT IS NULL, 1, null)) as ACTIVE_USERS, \nCOUNT(IFF(DELETED_AT IS NOT NULL, 1, null)) as DELETED_USERS\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_silver"}, "error": null, "status": "SUCCESS 1", "execution_time": 2.755668878555298, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:20:12.999047Z", "completed_at": "2020-08-15T03:20:13.028905Z"}, {"name": "execute", "started_at": "2020-08-15T03:20:13.029468Z", "completed_at": "2020-08-15T03:20:15.226866Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized=\"table\") }}\n\nSELECT dc.DEPUTY_EDITION, \ndl.DEPUTY_EDITION as CONVERTED_TO, \ndc.TIMESTAMP as START_TIME, \ndl.TIMESTAMP as END_TIME, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES, \ndc.DEPUTY_EDITION_ID, \ndc.DEPUTY_ID, \ndc.HOSTNAME, \ndc.PORTFOLIO_NAME, \ndc.REGION\nFROM {{ ref('deputy_created_bronze') }} dc \nLEFT JOIN {{ ref('deputy_last_updated_silver') }} dl ON dc.DEPUTY_ID = dl.DEPUTY_ID\nWHERE dc.DEPUTY_EDITION IN ('free', 'pro_trial') AND dl.DEPUTY_EDITION NOT IN ('free', 'pro_trial')", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "silver", "deputy_user_conversions_silver"], "unique_id": "model.deputy.deputy_user_conversions_silver", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "silver/deputy_user_conversions_silver.sql", "original_file_path": "models/silver/deputy_user_conversions_silver.sql", "name": "deputy_user_conversions_silver", "resource_type": "model", "alias": "deputy_user_conversions_silver", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_created_bronze"], ["deputy_last_updated_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_created_bronze", "model.deputy.deputy_last_updated_silver"]}, "description": "User's DEPUTY_EDITION conversions and the time taken", "columns": {"END_TIME": {"name": "END_TIME", "description": "", "meta": {}, "data_type": null, "tags": []}, "START_TIME": {"name": "START_TIME", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/silver/deputy_user_conversions_silver.sql", "compiled": true, "compiled_sql": "\n\nSELECT dc.DEPUTY_EDITION, \ndl.DEPUTY_EDITION as CONVERTED_TO, \ndc.TIMESTAMP as START_TIME, \ndl.TIMESTAMP as END_TIME, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES, \ndc.DEPUTY_EDITION_ID, \ndc.DEPUTY_ID, \ndc.HOSTNAME, \ndc.PORTFOLIO_NAME, \ndc.REGION\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_created_bronze dc \nLEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_last_updated_silver dl ON dc.DEPUTY_ID = dl.DEPUTY_ID\nWHERE dc.DEPUTY_EDITION IN ('free', 'pro_trial') AND dl.DEPUTY_EDITION NOT IN ('free', 'pro_trial')", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT dc.DEPUTY_EDITION, \ndl.DEPUTY_EDITION as CONVERTED_TO, \ndc.TIMESTAMP as START_TIME, \ndl.TIMESTAMP as END_TIME, \nTIMEDIFF(day, START_TIME, END_TIME) as ACTIVATION_DAYS, \nTIMEDIFF(hours, START_TIME, END_TIME) as ACTIVATION_HOURS,\nTIMEDIFF(minutes, START_TIME, END_TIME) as ACTIVATION_MINUTES, \ndc.DEPUTY_EDITION_ID, \ndc.DEPUTY_ID, \ndc.HOSTNAME, \ndc.PORTFOLIO_NAME, \ndc.REGION\nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_created_bronze dc \nLEFT JOIN ANALYTICS_ENG_DB.dbt_rho.deputy_last_updated_silver dl ON dc.DEPUTY_ID = dl.DEPUTY_ID\nWHERE dc.DEPUTY_EDITION IN ('free', 'pro_trial') AND dl.DEPUTY_EDITION NOT IN ('free', 'pro_trial')"}, "error": null, "status": "SUCCESS 1", "execution_time": 4.56627631187439, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:20:15.757734Z", "completed_at": "2020-08-15T03:20:15.789809Z"}, {"name": "execute", "started_at": "2020-08-15T03:20:15.790116Z", "completed_at": "2020-08-15T03:20:19.798701Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM {{ ref('deputy_user_conversions_silver') }}", "database": "ANALYTICS_ENG_DB", "schema": "dbt_rho", "fqn": ["deputy", "gold", "deputy_user_conversions_gold"], "unique_id": "model.deputy.deputy_user_conversions_gold", "package_name": "deputy", "root_path": "/usr/src/develop/user-8145/environment-9711/repository-8093", "path": "gold/deputy_user_conversions_gold.sql", "original_file_path": "models/gold/deputy_user_conversions_gold.sql", "name": "deputy_user_conversions_gold", "resource_type": "model", "alias": "deputy_user_conversions_gold", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["deputy_user_conversions_silver"]], "sources": [], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["model.deputy.deputy_user_conversions_silver"]}, "description": "Statistics on conversions", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": "models/tests.yml", "build_path": "target/run/deputy/models/gold/deputy_user_conversions_gold.sql", "compiled": true, "compiled_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_conversions_silver", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "SELECT \nCOUNT(1) as TOTAL_CONVERSIONS,\nROUND(AVG(ACTIVATION_DAYS), 1) as AVG_CONVERSION_DAYS,\nROUND(AVG(ACTIVATION_HOURS), 1) as AVG_CONVERSION_HOURS,\nROUND(AVG(ACTIVATION_MINUTES), 1) as AVG_CONVERSION_MINUTES \nFROM ANALYTICS_ENG_DB.dbt_rho.deputy_user_conversions_silver"}, "error": null, "status": "SUCCESS 1", "execution_time": 2.9900307655334473, "thread_id": "Thread-4", "timing": [{"name": "compile", "started_at": "2020-08-15T03:20:20.328005Z", "completed_at": "2020-08-15T03:20:20.360637Z"}, {"name": "execute", "started_at": "2020-08-15T03:20:20.360931Z", "completed_at": "2020-08-15T03:20:22.777255Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-08-15T03:20:25.644381Z", "elapsed_time": 45.25593543052673}